<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Терминал 100₽</title>
  <style>
    body { font-family: monospace; background: #000; color: #0f0; font-size: 32px; text-align: center; padding-top: 100px; }
    #log { margin-top: 50px; }
  </style>
</head>
<body>
  <h1>ПОДНЕСИТЕ КАРТУ</h1>
  <div>Баланс: <span id="balance">10000</span> ₽</div>
  <div id="log"></div>

  <script>
    let balance = 10000;

    if ('NDEFReader' in window) {
      const ndef = new NDEFReader();

      async function startScanning() {
        try {
          await ndef.scan();
          document.getElementById("log").innerText = "Слушаю NFC...";
          
          ndef.onreading = ({ message, serialNumber }) => {
            if (balance >= 100) {
              balance -= 100;
              document.getElementById("balance").innerText = balance;
              document.getElementById("log").innerText = 
                `СПИСАНО 100₽\nUID: ${serialNumber}\nБаланс: ${balance}₽`;
              
              // звук «бип»
              const audio = new Audio("https://www.soundjay.com/buttons/beep-07.mp3");
              audio.play();
            } else {
              document.getElementById("log").innerText = "НЕДОСТАТОЧНО СРЕДСТВ";
            }
          };
        } catch (error) {
          console.log("Ошибка: ", error);
        }
      }

      startScanning();
    } else {
      document.body.innerHTML = "<h1>Web NFC не поддерживается в этом браузере</h1>";
    }
  </script>
</body>
</html>